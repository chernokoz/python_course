# Домашнее задание №5

**Дедлайн**: 11.20.2019 12:10

## Задачи
#### 1. Пирамидальная сортировка (6,5 баллов)
В этом задании вам необходимо реализовать пирамидальную сортировку на генераторах.

Кучу (в нашем случае нужно, чтобы она была на минимум) будем представлять следующим образом:
  * пустая куча -- это генератор, не возвращающий ни одного элемента
  * непустая куча -- это генератор, возвращающий сначала кортеж `(value, size, depth)`, затем левую подкучу, 
    а затем правую (`value` -- это значение на вершине кучи, `size` -- число элементов в ней, `depth` -- ее высота).

Примечания:
  * Нельзя использовать никакие дополнительные модули.
  * Нельзя использовать кортежи, списки и прочие контейнеры нигде, кроме тех мест, где это специально оговорено в задании.

Функции:
  * `empty` (0,5 балла)
    
    Реализуйте пустую кучу.
    
  * `heapify` (1 балл)
    
    Реализуйте генератор `heapify`, представляющий собой ленивую кучу, построенную из значения и подкуч, переданных 
    ему в качестве аргументов.
    
  * `print_heap` (0,5 балл)
    
    Реализуйте функцию `print_heap`, выводящую переданную ей кучу в `stdout`.
      
  * `build_heap` (1 балл)
    
    Реализуйте функцию `build_heap`, строящую кучу из переданной ей произвольной последовательности с помощью `heapify` и `empty`. 
    Функция должна работать не хуже, чем за линейное время.
    Число операций, необходимое для того, чтобы напечатать построенную кучу функцией `print_heap`, должно быть `O(n)`.
    
  * `extract_last` (1 балл)
    
    Напишите генератор `extract_last`, извлекающий самый правый элемент из самого нижнего слоя кучи. 
    Он должен вызвращать сначала этот элемент, а затем измененную кучу уже без него.
    Время работы генератора должно быть `O(log n)`.
    
  * `extract_min` (1 балл)
    
    Напишите генератор `extract_min`, извлекающий из кучи минимум c помощью генератора из предыдущего пункта.
    Сначала он должен возвращать минимальный элемент, затем измененную кучу уже без него.
    Время работы генератора должно быть `O(log n)`.
    
  * `heap_sort` (0,5 балла)
    
    Напишите ленивую пирамидальную сортировку с использованием всего, что
    было написано в предыдущих пунктах. Полная сортировка последовательности из `n`
    элементов должна работать за `O(n log n)`.
    
  * `bench` (1 балл)
    
    Попробуйте понять, насколько быстро работает всё написанное. т.е. напишите объемный комментарий с асимптотиками
    всех функций из предыдущих заданий и **выводами**.
    Сравните скорость работы `heap_sort` со скоростью стандартной сортировки.
    В этой части нет жестких ограничений на то, как оценивать скорость работы, но как минимум вам необходимо
    несколько раз запустить обе сортировки на каких-то наборах данных, измерив время их работы.
    
#### 2. What needs to be done (1 балл)
Реализуйте декораторы [classmethod](https://docs.python.org/3/library/functions.html#classmethod) и 
[staticmethod](https://docs.python.org/3/library/functions.html#staticmethod).

Поведение этих декораторов должно совпадать с поведением встроенных, т.е.:
```python
class C:
    @staticmethod
    def f(arg1, arg2):
        print(arg1, arg2)

>>> C().f(1, 2)
1
2
>>> C.f(1, 2)
1
2

class C:
    @classmethod
    def f(cls):
        print(cls) 
>>> C().f()
<class '__main__.C'>
```

А также объясните в 2-4 предложениях ваше решение. **Без объяснения задание не засчитывается**. 

#### 3. contextmanager (1 балл)
Реализуйте декоратор `contextmanager`, позволяющий использовать генератор в качестве менеджера контекста. 

```python
@contextmanager
def foo():
    print("__enter__")
    try:
        yield 42
    except Exception as e:
        print(type(e))
        print(str(e))
    finally:
        print("__exit__")
    return

if __name__ == '__main__':
    with foo() as i:
        print(i)
        raise ValueError("OOOPS")

>>> __enter__
>>> 42
>>> <class 'ValueError'>
>>> OOOPS
>>> __exit__
```
